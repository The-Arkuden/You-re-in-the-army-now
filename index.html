<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>You're in the army now!</title>
    <style>
        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: #1a1a1a;
            color: #e4e4e4;
            margin: 0;
            padding: 0;
        }

        header {
            background-color: #333;
            color: #e4e4e4;
            text-align: center;
            padding: 20px;
            border-bottom: 4px solid #4CAF50;
        }

        .container {
            width: 90%;
            margin: 20px auto;
            padding: 20px;
            background-color: #252525;
            border: 4px solid #666;
            border-radius: 8px;
            box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.5);
            font-size: 18px;
        }

        .menu-buttons {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .menu-buttons button {
            padding: 15px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #444;
            color: #e4e4e4;
            border: 3px solid #777;
            border-radius: 5px;
            margin: 10px;
            box-shadow: inset 0px 0px 5px rgba(0, 0, 0, 0.5);
            font-family: 'Courier New', Courier, monospace;
        }

        .menu-buttons button:hover {
            background-color: #555;
            border-color: #4CAF50;
        }

        .output, .battle-screen {
            display: none;
            background-color: #2e2e2e;
            border-radius: 8px;
            padding: 20px;
            height: 200px;
            overflow-y: scroll;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            margin-bottom: 20px;
            color: #b8b8b8;
            box-shadow: inset 0px 0px 10px rgba(0, 0, 0, 0.7);
            border: 3px solid #777;
        }

        footer {
            text-align: center;
            margin-top: 20px;
            color: #777;
            font-size: 14px;
        }

        footer a {
            color: #4CAF50;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* To make battle buttons initially hidden */
        .order-buttons {
            display: none;
            justify-content: space-around;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

<header>
    <h1>You're in the army now!</h1>
    <p>Un jeu de stratégie et de gestion de batailles</p>
</header>

<div class="container" id="menu">
    <div class="menu-buttons">
        <button onclick="startCampaign()">Commencer la campagne militaire</button>
    </div>
</div>

<div class="container battle-screen" id="battleScreen">
    <div class="order-buttons" id="orderButtons">
        <button onclick="donnerOrdre('attaquer')">Attaquer</button>
        <button onclick="donnerOrdre('défendre')">Défendre</button>
        <button onclick="donnerOrdre('retraite')">Retraite</button>
        <button onclick="donnerOrdre('renforcer')">Renforcer</button>
        <button onclick="donnerOrdre('reconnaissance')">Reconnaissance</button>
    </div>

    <div class="output" id="output">
        <p>Bienvenue, Général ! Donnez vos ordres pour commencer la bataille.</p>
    </div>

    <div class="menu-buttons">
        <button onclick="returnToMenu()">Retourner au menu</button>
    </div>
</div>

<footer>
    <p>&copy; 2024 - You're in the army now! | Design inspiré par <a href="#">Dwarf Fortress</a></p>
</footer>

<script>
    // Variables de campagne et état des batailles
    let moralJoueur = 5;
    let moralEnnemi = 5;
    let batailleEnCours = 1;
    let nombreBatailles = 3;  // La campagne comporte 3 batailles
    let meteo = choisirMeteo();

    // Fonction pour commencer la campagne militaire
    function startCampaign() {
        document.getElementById("menu").style.display = "none";
        document.getElementById("battleScreen").style.display = "block";
        document.getElementById("orderButtons").style.display = "flex";
        afficher(`Bataille ${batailleEnCours} commencée !`);
    }

    // Fonction pour retourner au menu
    function returnToMenu() {
        document.getElementById("battleScreen").style.display = "none";
        document.getElementById("menu").style.display = "block";
    }

    // Fonction pour afficher le résultat dans la console du jeu
    function afficher(message) {
        const output = document.getElementById("output");
        output.innerHTML += `<p>${message}</p>`;
        output.scrollTop = output.scrollHeight;  // Scroll vers le bas pour voir le dernier message
    }

    // Fonction pour donner un ordre
    function donnerOrdre(ordre) {
        afficher(`Vous donnez l'ordre de ${ordre}.`);
        let resultatJoueur = executerOrdre(ordre, "joueur");
        let ordreEnnemi = choisirOrdreEnnemi();
        let resultatEnnemi = executerOrdre(ordreEnnemi, "ennemi");

        afficher(`L'ennemi a donné l'ordre de ${ordreEnnemi}.`);

        // Résolution de la bataille pour ce tour
        resoudreBataille(resultatJoueur, resultatEnnemi);
    }

    // Fonction pour exécuter l'ordre du joueur ou de l'ennemi
    function executerOrdre(ordre, camp) {
        let moral = camp === "joueur" ? moralJoueur : moralEnnemi;
        let resultat;

        switch (ordre) {
            case "attaquer":
                resultat = moral > 5 ? "attaque réussie" : "attaque échouée";
                break;
            case "défendre":
                resultat = moral > 3 ? "défense solide" : "défense fragile";
                break;
            case "retraite":
                resultat = moral < 3 ? "retraite désorganisée" : "retraite organisée";
                break;
            case "renforcer":
                moral += 1;
                resultat = "renforcement effectué";
                break;
            case "reconnaissance":
                resultat = "reconnaissance en cours";
                break;
            default:
                resultat = "ordre inconnu";
        }

        // Mettre à jour le moral
        if (camp === "joueur") {
            moralJoueur = moral;
        } else {
            moralEnnemi = moral;
        }

        afficher(`${camp === "joueur" ? "Vos troupes" : "Les troupes ennemies"} ${resultat}.`);
        return resultat;
    }

    // Fonction pour choisir un ordre aléatoire pour l'ennemi
    function choisirOrdreEnnemi() {
        const ordres = ["attaquer", "défendre", "retraite", "renforcer", "reconnaissance"];
        return ordres[Math.floor(Math.random() * ordres.length)];
    }

    // Fonction pour résoudre la bataille
    function resoudreBataille(resultatJoueur, resultatEnnemi) {
        // Simple résolution pour savoir qui prend l'avantage
        if (resultatJoueur.includes("réussie") && !resultatEnnemi.includes("réussie")) {
            afficher("Vos troupes prennent l'avantage !");
            moralEnnemi -= 2;
        } else if (!resultatJoueur.includes("réussie") && resultatEnnemi.includes("réussie")) {
            afficher("L'ennemi prend l'avantage !");
            moralJoueur -= 2;
        } else {
            afficher("Les deux camps sont à égalité.");
        }

        // Vérifier si la bataille est terminée
        if (moralJoueur <= 0) {
            afficher("Votre armée est en déroute. Vous avez perdu !");
            terminerBataille(false);
        } else if (moralEnnemi <= 0) {
            afficher("L'ennemi est en déroute. Vous avez gagné !");
            terminerBataille(true);
        }
    }

// Fonction pour terminer la bataille
    function terminerBataille(victoire) {
        if (victoire) {
            afficher(`Vous avez remporté la bataille ${batailleEnCours}!`);
        } else {
            afficher(`Vous avez perdu la bataille ${batailleEnCours}.`);
        }

        batailleEnCours++;

        // Si toutes les batailles de la campagne sont terminées
        if (batailleEnCours > nombreBatailles) {
            afficher("La campagne est terminée !");
            desactiverBoutons();
        } else {
            // Réinitialiser les valeurs pour la prochaine bataille
            moralJoueur = 5;
            moralEnnemi = 5;
            afficher(`Préparez-vous pour la bataille ${batailleEnCours}.`);
        }
    }

    // Fonction pour désactiver les boutons à la fin de la bataille/campagne
    function desactiverBoutons() {
        const buttons = document.querySelectorAll(".order-buttons button");
        buttons.forEach(button => button.disabled = true);
        afficher("Campagne terminée. Retournez au menu principal pour rejouer.");
        document.getElementById("orderButtons").style.display = "none";
    }

    // Fonction pour choisir la météo
    function choisirMeteo() {
        const conditions = ["soleil", "pluie", "vent", "nuageux"];
        return conditions[Math.floor(Math.random() * conditions.length)];
    }
</script>

</body>
</html>